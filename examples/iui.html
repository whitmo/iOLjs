<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
         "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>iOL Editor</title>
<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;"/>
<style type="text/css" media="screen">@import "../externals/iui/iui/iui.css";</style>
<style>
    #map {
        height: 300px;
        z-index: 1;        
    }
</style>
<script type="application/x-javascript" src="../script/OpenLayers.js"></script>
<script type="application/x-javascript" src="../script/xlog.js">
    var url = "http://localhost/cgi-bin/xlog.cgi";
    OpenLayers.Console.log = xlog.log;
</script>
<script type="application/x-javascript" src="../script/iol.js"></script>
<script type="application/x-javascript" src="../externals/iui/iui/iui.js"></script>
<script type="application/x-javascript">

    function activatePoint(event) {
        drawPoint.activate();
        xlog.log("point " + drawPoint.active);
    }
    function activateLine(event) {
        xlog.log("line " + event.target.checked);
    }
    function activatePolygon(event) {
        xlog.log("polygon " + event.target.checked);
    }
    function activateNavigation(event) {
        drawPoint.deactivate();
        xlog.log("navigate " + event.target.checked);
    }
    
    var map, vectors, drawPoint;
    function init() {
        
        $("point").addEventListener("change", activatePoint, false);
        $("line").addEventListener("change", activateLine, false);
        $("polygon").addEventListener("change", activatePolygon, false);
        $("navigate").addEventListener("change", activateNavigation, false);
        
        vectors = new OpenLayers.Layer.Vector("Vectors");
        drawPoint = new OpenLayers.Control.DrawFeature(vectors, {
            handler: IOL.Handler.Point
        });

        map = new OpenLayers.Map('map', {
            controls: [
                new IOL.Control.Navigation(), drawPoint
            ],
            numZoomLevels: 7
        });
        
        var wms = new OpenLayers.Layer.WMS(
            "Imagery", "http://demo.opengeo.org:80/geoserver/wms",
            {
                srs: 'EPSG:4326',
                layers: 'topp:bluemarble',
                format: 'image/png',
                tiled: 'true',
                tilesOrigin : "-180,-90"
            }
        );

        map.addLayers([wms, vector]);

        map.setCenter(new OpenLayers.LonLat(-80, 33), 3);
    }

    window.addEventListener("load", init, false);
</script>
</head>

<body>
    <div class="toolbar">
        <h1 id="pageTitle"></h1>
        <a id="backButton" class="button" href="#"></a>
        <a class="button" href="#controlPanel">Settings</a>
    </div>
    <div id="map" title="Map" class="panel" selected="true">
    </div>

    <form id="controlPanel" class="dialog">
        <fieldset>
            <h1>Settings</h1>
            <a class="button blueButton" type="cancel">Done</a>
            <div class="row"></div>
            <div class="row">
                <label for="point">Draw Points</label>
                <input id="point" type="radio" name="draw" />
            </div>            
            <div class="row">
                <label for="line">Draw Lines</label>
                <input id="line" type="radio" name="draw" />
            </div>            
            <div class="row">
                <label for="polygon">Draw Polygons</label>
                <input id="polygon" type="radio" name="draw" />
            </div>            
            <div class="row">
                <label for="navigate">Navigate</label>
                <input id="navigate" type="radio" name="draw" checked="checked"/>
            </div>            
        </fieldset>
    </form>
</body>
</html>
